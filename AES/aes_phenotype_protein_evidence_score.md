# Advanced Explanation System (AES)
*Target Identification: Phenotype associated with Protein workflow*

## 1. Background
The AES is one means by which the Explanatory Agent provides the ability to evaluate, order, and organize Translator Knowledge Provider (KP) assertions i.e., subject-predicate-object triples returned by one or more KPs. Specifically, AES involves an independent querying system, congruent to Translator KP queries, which provides corroborating assertions for comparison. Furthermore, AES provides vectorized encodings of biochemical and biomedical entity properties (e.g., proteins, chemicals, and phenotypes), are used to score Translator results by virtue of their similarity to AES-derived results. This strategy evaluates the extent to which translator responses are consistent with independently obtained answers to a query, and to which the properties of those answers align with known associations.
## 2. AES query workflow description
When the Explanatory Agent receives a query related to the identification of proteins associated with phenotypes, it triggers a process housed at Tufts Analytics Platform (TAP) which performs a custom query of the [Target Central Resource Database (TCRD)](http://juniper.health.unm.edu/tcrd/) which attempts to optimize protein targets based on evidence of pathological contribution of the protein to the phenotype, and drug target-ability. Phenotype associated protein targets are listed and converted into Biolink compliant identifiers, which serve as the AES-derived protein answers to the query.
## 3. AES feature engineering process
Concurrently, TAP also creates a matrix of engineered features for proteins and places these into an adjacency matrix for profiling. In this case, each protein feature profile is represented as a Boolean vector of the [Gene Ontology (GO)](http://geneontology.org/) terms to which they are annotated, obtained from the GO Annotation database table included in TCRD. To summarize, this matrix has rows representing every protein accession from UniProt and columns representing every GO term. 
## 4. Answer scoring
After KPs and AES return their respective answer responses, each are mapped to the ontology term represented in the rows of the feature vector matrix (in this case [UniProt accessions](https://www.uniprot.org/help/accession_numbers)) and a subset of the matrix is filtered for each set of protein targets obtained from KPs and AES to produce two adjacency matrices of protein vectors. 

For each protein (row) in the KP-produced matrix, a cosine similarity is computed against the entire AES-produced matrix. The resulting KP protein vector is a list of cosine scores indicating how consistently each feature (GO term) was shared among all AES-identified phenotype-protein associations. An average cosine score is then be obtained for each KP protein result and returned as the score for consistency in the Explanatory Agentâ€™s response.
